
// CONSTACIA CUMPLIDO 
const querygetconstcompliment = `	
SELECT substring(SB.SHIPMENT_GID,5,LENGTH(SB.SHIPMENT_GID))SHIPMENT_GID
   ,substring(SB.POWER_UNIT_GID,5,LENGTH(SB.POWER_UNIT_GID)) POWER_UNIT_GID
   ,substring(SB.DRIVER_GID from '%#"__________%_#"%' for '#') DRIVER_GID
   ,SB.SOURCE_LOCATION_GID
   ,SB.DEST_LOCATION_GID
   ,SB.TIQUETE_CARGUE
   ,'FECHA_CUMPLIDO' AS FECHA_CUMPLIDO
   ,ROUND(SB.PESO_CARGUE,3) as PESO_CARGUE
   ,SB.TOTAL_WEIGHT_UOM_CODE
   ,'FLETE' AS FLETE
   ,'ANTICIPO' AS ANTICIPO
   ,TO_CHAR(NOW(), 'YYYY-MM-DD HH24:MI') AS FECHA_CONSTANCIA_CUMPLIDO
FROM
    OTM.OT_SHIPMENT_BUY SB
    INNER JOIN (
    SELECT
    MAX(SHIPMENT_GID) AS SHIPMENT_GID
    FROM
    OTM.OT_SHIPMENT_BUY
    WHERE
    POWER_UNIT_GID LIKE '%'||$1
    OR SHIPMENT_GID LIKE '%'||$2
    OR DRIVER_GID LIKE '%'||$3
    ) CC ON (CC.SHIPMENT_GID = SB.SHIPMENT_GID)
`;




module.exports = {
    querygetconstcompliment
}