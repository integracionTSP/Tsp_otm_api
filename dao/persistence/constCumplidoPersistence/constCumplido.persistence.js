
// CONSTACIA CUMPLIDO 
const querygetconstcompliment= `	
SELECT substring(SB.SHIPMENT_GID,5,LENGTH(SB.SHIPMENT_GID))SHIPMENT_GID
   ,substring(SB.POWER_UNIT_GID,5,LENGTH(SB.POWER_UNIT_GID)) POWER_UNIT_GID
   ,SPLIT_PART(DRIVER_GID,'_',3) DRIVER_GID
   ,SB.SOURCE_LOCATION_GID
   ,SB.DEST_LOCATION_GID
   ,SB.TIQUETE_CARGUE
   ,TO_CHAR(SB.INSERT_DATE_DESCARGUE, 'YYYY-MM-DD HH24:MI') AS FECHA_CUMPLIDO 
   ,ROUND(SB.PESO_CARGUE,3) as PESO_CARGUE
   ,SB.TOTAL_WEIGHT_UOM_CODE
   ,'FLETE' AS FLETE
   ,'ANTICIPO' AS ANTICIPO
   ,TO_CHAR(NOW(), 'YYYY-MM-DD HH24:MI') AS FECHA_CONSTANCIA_CUMPLIDO
FROM
    OTM.OT_SHIPMENT_BUY SB
    INNER JOIN (
    SELECT
    SHIPMENT_GID AS SHIPMENT_GID
    FROM
    OTM.OT_SHIPMENT_BUY
    WHERE
    POWER_UNIT_GID LIKE '%'||$1
    AND INSERT_DATE_DESCARGUE  BETWEEN $2 AND $3 
    ) CC ON (CC.SHIPMENT_GID = SB.SHIPMENT_GID)

`;

const queryAddOpeConstcompliment = `
INSERT INTO otm.??? (
	 SHIPMENT_GID
	,POWER_UNIT_GID
	,DRIVER_GID
	,INSERT_DATE
	,INSERT_USER
	,FECHA_CONSTANCIA_CUMPLIDO
	,TIQUETE_CARGUE
	,SOURCE_LOCATION_GID
	,DEST_LOCATION_GID
	)
VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9)

`




module.exports = {
    querygetconstcompliment,
    queryAddOpeConstcompliment
}